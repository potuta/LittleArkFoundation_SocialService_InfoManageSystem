@model LittleArkFoundation.Areas.Admin.Models.OPD.OPDViewModel
@{
    ViewData["Title"] = "Edit Statistics";
    Layout = "_AdminLayout";
    string? sortToggle = ViewBag.sortToggle ?? "01";
    string? sortByUserID = ViewBag.sortByUserID ?? "";
	string? sortToggleText = ViewBag.sortToggleText ?? "JAN";
}

<style>
    .menu-bar a {
        min-width: 100px;
        text-align: center;
        transition: background-color 0.2s ease, color 0.2s ease;
    }

    .header-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        margin-bottom: 1rem;
    }

        .header-bar h2 {
            margin-bottom: 0;
        }

</style>

<div class="header-bar">
    <h2>OPD Statistics</h2>

    <div class="menu-bar d-flex gap-2">
        <a class="btn btn-outline-dark @(
           ViewContext.RouteData.Values["action"]?.ToString() == "Index" ||
           ViewContext.RouteData.Values["action"]?.ToString() == "SortBy" ||
           ViewContext.RouteData.Values["action"]?.ToString() == "Search"
           ? "active" : "")"
           asp-action="Index" asp-controller="OPD">Main</a>

        <a class="btn btn-outline-dark @(ViewContext.RouteData.Values["action"]?.ToString() == "Reports" ? "active" : "")"
           asp-action="Reports" asp-controller="OPD">Reports</a>

        <a class="btn btn-outline-dark @(
                           ViewContext.RouteData.Values["action"]?.ToString() == "Statistics" ||
                           ViewContext.RouteData.Values["action"]?.ToString() == "SortByStatistics" ||
                            ViewContext.RouteData.Values["action"]?.ToString() == "EditStatistics"
                           ? "active" : "")"
           asp-action="Statistics" asp-controller="OPD">Statistics</a>
    </div>
</div>
<hr />

<!-- Back to List -->
<div class="mt-2">
    <a class="btn btn-outline-secondary mb-3" asp-controller="OPD" asp-action="Statistics">← Back to Statistics</a>
</div>

<div class="d-flex justify-content-between align-items-start flex-wrap gap-2 mb-3">
@* Left toggles/buttons *@
    <div class="d-flex align-items-center gap-3">
        <div class="btn-group btn-group-toggle" data-toggle="buttons">
            <a asp-action="EditStatistics" asp-controller="OPD" asp-route-sortToggle="01"
               class="btn btn-secondary @(sortToggle == "01" ? "active" : "")">
                <div class="custom-radio">
                    <input type="radio" style="accent-color: dodgerblue" value="main" @(sortToggle == "01" ? "checked" : "")>
                    <label style="margin-bottom: 0">JAN</label>
                </div>
            </a>
            <a asp-action="EditStatistics" asp-controller="OPD" asp-route-sortToggle="02"
               class="btn btn-secondary @(sortToggle == "02" ? "active" : "")">
                <div class="custom-radio">
                    <input type="radio" style="accent-color: dodgerblue" value="main" @(sortToggle == "02" ? "checked" : "")>
                    <label style="margin-bottom: 0">FEB</label>
                </div>
            </a>
            <a asp-action="EditStatistics" asp-controller="OPD" asp-route-sortToggle="03"
               class="btn btn-secondary @(sortToggle == "03" ? "active" : "")">
                <div class="custom-radio">
                    <input type="radio" style="accent-color: dodgerblue" value="main" @(sortToggle == "03" ? "checked" : "")>
                    <label style="margin-bottom: 0">MARCH</label>
                </div>
            </a>
            <a asp-action="EditStatistics" asp-controller="OPD" asp-route-sortToggle="04"
               class="btn btn-secondary @(sortToggle == "04" ? "active" : "")">
                <div class="custom-radio">
                    <input type="radio" style="accent-color: dodgerblue" value="main" @(sortToggle == "04" ? "checked" : "")>
                    <label style="margin-bottom: 0">APRIL</label>
                </div>
            </a>
            <a asp-action="EditStatistics" asp-controller="OPD" asp-route-sortToggle="05"
               class="btn btn-secondary @(sortToggle == "05" ? "active" : "")">
                <div class="custom-radio">
                    <input type="radio" style="accent-color: dodgerblue" value="main" @(sortToggle == "05" ? "checked" : "")>
                    <label style="margin-bottom: 0">MAY</label>
                </div>
            </a>
            <a asp-action="EditStatistics" asp-controller="OPD" asp-route-sortToggle="06"
               class="btn btn-secondary @(sortToggle == "06" ? "active" : "")">
                <div class="custom-radio">
                    <input type="radio" style="accent-color: dodgerblue" value="main" @(sortToggle == "06" ? "checked" : "")>
                    <label style="margin-bottom: 0">JUNE</label>
                </div>
            </a>
            <a asp-action="EditStatistics" asp-controller="OPD" asp-route-sortToggle="07"
               class="btn btn-secondary @(sortToggle == "07" ? "active" : "")">
                <div class="custom-radio">
                    <input type="radio" style="accent-color: dodgerblue" value="main" @(sortToggle == "07" ? "checked" : "")>
                    <label style="margin-bottom: 0">JULY</label>
                </div>
            </a>
            <a asp-action="EditStatistics" asp-controller="OPD" asp-route-sortToggle="08"
               class="btn btn-secondary @(sortToggle == "08" ? "active" : "")">
                <div class="custom-radio">
                    <input type="radio" style="accent-color: dodgerblue" value="main" @(sortToggle == "08" ? "checked" : "")>
                    <label style="margin-bottom: 0">AUG</label>
                </div>
            </a>
            <a asp-action="EditStatistics" asp-controller="OPD" asp-route-sortToggle="09"
               class="btn btn-secondary @(sortToggle == "09" ? "active" : "")">
                <div class="custom-radio">
                    <input type="radio" style="accent-color: dodgerblue" value="main" @(sortToggle == "09" ? "checked" : "")>
                    <label style="margin-bottom: 0">SEPT</label>
                </div>
            </a>
            <a asp-action="EditStatistics" asp-controller="OPD" asp-route-sortToggle="10"
               class="btn btn-secondary @(sortToggle == "10" ? "active" : "")">
                <div class="custom-radio">
                    <input type="radio" style="accent-color: dodgerblue" value="main" @(sortToggle == "10" ? "checked" : "")>
                    <label style="margin-bottom: 0">OCT</label>
                </div>
            </a>
            <a asp-action="EditStatistics" asp-controller="OPD" asp-route-sortToggle="11"
               class="btn btn-secondary @(sortToggle == "11" ? "active" : "")">
                <div class="custom-radio">
                    <input type="radio" style="accent-color: dodgerblue" value="main" @(sortToggle == "11" ? "checked" : "")>
                    <label style="margin-bottom: 0">NOV</label>
                </div>
            </a>
            <a asp-action="EditStatistics" asp-controller="OPD" asp-route-sortToggle="12"
               class="btn btn-secondary @(sortToggle == "12" ? "active" : "")">
                <div class="custom-radio">
                    <input type="radio" style="accent-color: dodgerblue" value="main" @(sortToggle == "12" ? "checked" : "")>
                    <label style="margin-bottom: 0">DEC</label>
                </div>
            </a>
        </div>

    </div>
</div>

@if (TempData["SuccessMessage"] != null)
{
    <div class="alert alert-success alert-dismissible fade show" role="alert" style="width: 60%;">
        @TempData["SuccessMessage"]
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}
@if (TempData["ErrorMessage"] != null)
{
    <div class="alert alert-danger alert-dismissible fade show" role="alert" style="width: 60%;">
        @TempData["ErrorMessage"]
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}

<form asp-action="EditStatistics" asp-route-userID="@Model.User.UserID" asp-route-sortToggle="@sortToggle" method="post">
    <input type="hidden" asp-for="Statistics.Id" />
    <input type="hidden" asp-for="Statistics.Type" />
    <input type="hidden" asp-for="Statistics.UserID" />
    <input type="hidden" asp-for="Statistics.Date" />
    @Html.AntiForgeryToken()
    <div class="container-fluid px-0 mx-0" style="max-width: 1600px;">
        <div class="table-responsive" style="overflow-x: auto;">
            <table class="table" style="min-width: 1200px;">
                <thead>
                    @if (Model != null)
                    {
                        <tr>
                            <th style="white-space: nowrap; font-weight: bold; text-align:center;">@Model.User.Username</th>
                            <th>Actions</th>
                        </tr>
                    }
                </thead>
                <tbody>
                    @if (Model != null)
                    {
                        <tr>
                            <td style="white-space: nowrap; font-weight: bold;">I. SOURCE OF REFERRAL</td>
                        
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">Referring Party</td>
                        
                        </tr>

                        var sourceOfReferral = new Dictionary<string, string>
                                    {
                                    { "1. Government Hospital", "Govt. Hosp." },
                                    { "2. Private Hospital", "Private/Clinic" },
                                    { "3. Politicians", "Politicians" },
                                    { "4. Media", "Media" },
                                    { "5. Health Care Team", "Health Care Team" },
                                    { "6. NGOs/Private Welfare Agencies", "NGO/Private Welfare" },
                                    { "7. Government Agencies (DSWD, DOH Officials)", "Govt. Agencies" },
                                    { "8. Walk-in", "Walk in" },
                                    { "9. Others (employers, former pts, colleagues, friends)", "Others" },

                                    };

                        @foreach (var source in sourceOfReferral)
                        {
                            var key = source.Key;
                            var value = source.Value;
                            var count = Model.OPDList.Count(m => m.SourceOfReferral.Equals(value, StringComparison.OrdinalIgnoreCase) && m.Date.Month == int.Parse(sortToggle));

                            <tr>
                                <td style="white-space: nowrap;">@key</td>
                                <td style="white-space: nowrap;">
                                    <input type="number" 
                                        asp-for="Statistics.i_GovernmentHospital" value="@count"
                                        class="text-muted"
                                        style="cursor: not-allowed;"
                                        disabled/>
                                </td>
                            </tr>
                        }

                        <tr>
                            <td style="white-space: nowrap; font-weight: bold;">II. CASELOAD ACCORDING TO SERVICES</td>
                            
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1. During Census</td>
                            
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.1 New Cases</td>

                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_DuringCensus_NewCases" value="@Model.OPDList.Count(m => !m.IsOld && m.Date.Month == int.Parse(sortToggle))"
                                       class="text-muted"
                                       style="cursor: not-allowed;"
                                       disabled />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.2 Old Cases</td>

                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_DuringCensus_OldCases" value="@Model.OPDList.Count(m => m.IsOld && m.Date.Month == int.Parse(sortToggle))"
                                       class="text-muted"
                                       style="cursor: not-allowed;"
                                       disabled />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">2. Closed Summary</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_ClosedSummary" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">3. Number of patients based on sectoral groupings mandated by law/policies:</td>
                            
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">a. PWD</td>

                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_NoPatients_PWD" value="@Model.OPDList.Count(m => m.IsPWD && m.Date.Month == int.Parse(sortToggle))"
                                       class="text-muted"
                                       style="cursor: not-allowed;"
                                       disabled />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">b. Indigenous People</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_NoPatients_IndigenousPeople" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">c. Government Workers</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_NoPatients_GovernmentWorkers" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap; font-weight: bold;">SERVICES</td>
                            
                        </tr>

                        <tr>
                            <td style="white-space: nowrap; font-weight: bold;">1. Planning, Screening and Eligibility Study / PSE</td>
                            
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.1 Socio Economic Classification</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Planning_SocioEconomicClassification" />
                            </td>
                            
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.2 Pre-admission Planning</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Planning_PreAdmissionPlanning" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.3 Information Services/Orientation</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Planning_InformationServices" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap; font-weight: bold;">2. Concrete and Referral Services</td>
                            
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">2.1 Provision of Discount</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Concrete_ProvisionDiscount" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">2.2 Facilitating Referrals</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Concrete_FacilitatingReferrals" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">2.2.1 Outgoing Referrals for:</td>
                            
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">a. Medical Assistance</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Concrete_OutgoingReferrals_MedicalAssistance" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">b. Discount on Procedure/Hospital Expenses</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Concrete_OutgoingReferrals_DiscountProcedure" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">c. Transportation Fare</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Concrete_OutgoingReferrals_TransportationFare" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">d. Institutional Placement</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Concrete_OutgoingReferrals_InstitutionalPlacement" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">e. Temporary Shelter</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Concrete_OutgoingReferrals_TemporaryShelter" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">f. Funeral Assistance/Pauper's Burial</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Concrete_OutgoingReferrals_FuneralAssistance" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">g. Others specify (networking)</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Concrete_OutgoingReferrals_OthersSpecify" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">2.2.2 Incoming Referrals</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Concrete_IncomingReferrals" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap; font-weight: bold;">3. Psychosocial Counseling</td>
                            
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">Ten Leading Causes for Counselling</td>
                            
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1. Stress of the family</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Psychosocial_TenLeading_StressFamily" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">2. Refusal of patient to take home</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Psychosocial_TenLeading_RefusalPatientTakeHome" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">3. Anxiety of health cost</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Psychosocial_TenLeading_AnxietyHealth" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">4. Marital problem</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Psychosocial_TenLeading_MaritalProblem" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">5. Refusal of patient for treatment</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Psychosocial_TenLeading_RefusalPatientTreatment" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">6. Unbecoming attitude due to postponement if surgery</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Psychosocial_TenLeading_UnbecomingAttitude" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">7. Emotional problem</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Psychosocial_TenLeading_EmotionalProblem" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">8. Neglected children</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Psychosocial_TenLeading_NeglectedChildren" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">9. Sexually abuse</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Psychosocial_TenLeading_SexuallyAbuse" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">10. Adjustment problem</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Psychosocial_TenLeading_AdjustedProblem" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">3.2 Family Counselling</td>
                            
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">a. Social Worker</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Psychosocial_FamilyCounseling_SocialWorker" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">b. Health Care Team</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Psychosocial_FamilyCounseling_HealthCareTeam" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">3.3 Psychosocial Crisis Intervention</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Psychosocial_PsychosocialCrisis" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">3.4 Group Work/Per Session</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Psychosocial_GroupWork" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">3.5 Patients/Watchers Education</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Psychosocial_PatientsEducation" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">3.6 Mutual Support Group Session</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Psychosocial_MutualSupport" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">3.7 Advocacy Group</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Psychosocial_AdvocacyGroup" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap; font-weight: bold;">4. Discharges Services</td>
                            
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">a. Discharge Planning</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Discharges_DischargePlanning" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">b. Facilitation of Discharge</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Discharges_FacilitationDischarge" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">c. Pre-termination Counseling</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Discharges_PreTerminationCounseling" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">d. Home Conduction</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Discharges_HomeConduction" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap; font-weight: bold;">5. Support Services</td>
                            
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">5.1 Ward Visitation</td>
                            
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">a. Individual</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Support_Ward_Individual" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">b. Team</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Support_Ward_Team" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap; font-weight: bold;">6. Case Conferences</td>
                            
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">a. Multi Disciplinary</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Case_MultiDisciplinary" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">b. MSWD</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Case_MSWD" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap; font-weight: bold;">7. Follow-up Services</td>
                            
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">7.1 Home Visit</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_FollowUp_HomeVisit" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">7.2 Letters Sent</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_FollowUp_LettersSent" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">7.3 Contact of Relatives by Telephone</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_FollowUp_ContactRelativesTelephone" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">7.4 Contact of Relatives through Mass Media</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_FollowUp_ContactRelativesMassMedia" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap; font-weight: bold;">8. Coordination/Initiated by MSW</td>
                            
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">a. Physicians</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Coordination_Physicians" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">b. Nurses</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Coordination_Nurses" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">c. Pharmacist</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Coordination_Pharmacist" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">d. Nutritionist</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Coordination_Nutritionist" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">e. Other Staff</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Coordination_OtherStaff" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">f. Management</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Coordination_Management" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap; font-weight: bold;">9. Consultative and Advisory Services</td>
                            
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">a. Physicians</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Consultive_Physicians" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">b. Office Staff</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Consultive_OfficeStaff" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">c. Outside Hospital</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.ii_Consultive_OutsideHospital" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap; font-weight: bold;">10. Community Outreach</td>
                            
                        </tr>

                        <tr>
                            <td style="white-space: nowrap; font-weight: bold;">III. CASE MANAGEMENT SERVICES</td>
                           
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.1 Pre admission Counselling</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_PreAdmissionCounseling" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.2 Intake Interview</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_IntakeInterview" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.3 Collateral Interview</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_CollateralInterview" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.4 Issuance of MSS Card</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_IssuanceMSSCard" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.5 Indicate classification in the chart (in pts only)</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_IndicateClassification" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.6 Psychosocial Assessment</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_PsychosocialAssessment" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.7 Psychosocial Counselling</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_PsychosocialCounseling" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.8 Coordination w/ Multidiciplinary Team</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_CoordinationMultidisciplinary" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.9 Completion of Intake Form</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_CompletionIntakeForm" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.10 Health Education</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_HealthEducation" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.11 Crisis Intervention</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_CrisisIntervention" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.12 Concrete Services</td>
                            
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.12.1 Facilitaion/Provision of Meds/Procedures</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_ConcreteServices_Facilitation" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.12.2 Transportation Assistance (w/in MSS resources)</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_ConcreteServices_Transportation" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.12.3 Material Assistance (food, clothing)</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_ConcreteServices_MaterialAssistance" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.12.4 Financial Assistance (w/in MSS resources)</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_ConcreteServices_FinancialAssistance" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.13 Referral</td>
                            
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.13.1 Facilitating Incoming Referral</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_Referral_Facilitating" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.13.2 Preparing the Referral</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_Referral_Preparing" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.13.3 Coordination w/ the Receiveing Agency</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_Referral_Coordination" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.14 Ward Rounds (no. of pts visited)</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_WardRounds" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.15 Home Visitation</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_HomeVisitation" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.16 Advocacy Role</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_AdvocacyRole" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.17 Education</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_Education" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.18 Therapeutic Social Work Services</td>
                            
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.18.1 Abandoned</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_Therapeutic_Abandoned" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.18.2 Sexually Abused</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_Therapeutic_SexuallyAbused" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.18.3 Neglected</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_Therapeutic_Neglected" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.18.4 Battered</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_Therapeutic_Battered" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.19 Protective Services</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_ProtectiveServices" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.20 Grief Work</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_GriefWork" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.21 Behavioral Modification</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_Behavioral" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.22 Networking (meeting w/ other institution/grp org.)</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_Networking" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.23 Politicians</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_Politicians" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.24 Coordination w/ Mass Media</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_CoordinationMassMedia" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.25 Consultaion/Advisory Services</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_ConsultationAdvisory" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.26 Attendance to Case Conferences Committee Meetings</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_AttendanceCaseConference" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.27 Attendance to Clinical Comittees</td>
                            
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.27.1 Disharge Planning</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_AttendanceClinical_Discharge" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.27.2 Facilitation of Discharge</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_AttendanceClinical_Facilitation" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.27.3 Home Conduction</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_AttendanceClinical_Home" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.28 Follow up Services</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_FollowUpServices" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.29 Documentation</td>
                            
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.29.1 Profile</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_Documentation_Profile" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.29.2 Progress Notes</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_Documentation_ProgressNotes" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.29.3 Groupwork Recording</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_Documentation_GroupWork" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.29.4 Social Case Study Report/Social Case Summary</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_Documentation_SocialCase" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.29.5 Home Visit Report</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_Documentation_HomeVisit" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.30 Palliative Care</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_Palliative" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.31 Facilitation of Unclaimed Cadaver</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_FacilitationUnclaimed" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.32 Post Discharge Services</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_PostDischarge" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.33 Follow up Services through text/phone</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_FollowUpServicesText" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.34 Follow up Treatment Plans</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_FollowUpTreatment" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.35 Follow up of Rehabilitation Plans</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_FollowUpRehabilitation" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.36 Rehabilitation Services</td>
                            
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.36.1 Skills Training</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_Rehabilitation_Skills" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.36.2 Job Placement</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_Rehabilitation_Job" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.36.3 Capital Assistance</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_Rehabilitation_Capital" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.37 MSWD Fund Raising Activity</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_MSWDFund" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.38 Hospital Activity</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_HospitalActivity" />
                            </td>
                        </tr>

                        <tr>
                            <td style="white-space: nowrap;">1.39 Linkage w/ Donors</td>
                            <td style="white-space: nowrap;">
                                <input type="number"
                                       asp-for="Statistics.iii_LinkageDonors" />
                            </td>
                        </tr>

                    }
                </tbody>
            </table>
        </div>
    </div>

    <div class="d-flex justify-content-center align-items-center mt-2">
        <button type="submit" class="btn btn-sm btn-primary"
                onclick="return confirm('Are you sure you want to save changes?');">
            Save Changes (@sortToggleText)
        </button>
    </div>
    <div class="d-flex justify-content-center align-items-center mt-2">
        <a class="btn btn-sm btn-outline-primary" asp-action="Statistics"
           onclick="return confirm('Are you sure you want to exit this page?');">Back to Statistics</a>
    </div>
</form>
