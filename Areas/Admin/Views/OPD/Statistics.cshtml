@model LittleArkFoundation.Areas.Admin.Models.OPD.OPDViewModel
@{
    ViewData["Title"] = "Statistics";
    Layout = "_AdminLayout";
    string? sortBy = ViewBag.sortBy ?? "";
    string? sortByUserID = ViewBag.sortByUserID ?? "";
    string? sortByMonth = ViewBag.sortByMonth ?? "";
    bool matchedUser = Model.Users.Any(u => u.Username == sortBy);

}

<style>
    .menu-bar a {
        min-width: 100px;
        text-align: center;
        transition: background-color 0.2s ease, color 0.2s ease;
    }

    .header-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        margin-bottom: 1rem;
    }

        .header-bar h2 {
            margin-bottom: 0;
        }

</style>

<div class="header-bar">
    <h2>OPD Statistics</h2>

    <div class="menu-bar d-flex gap-2">
        <a class="btn btn-outline-dark @(
           ViewContext.RouteData.Values["action"]?.ToString() == "Index" ||
           ViewContext.RouteData.Values["action"]?.ToString() == "SortBy" ||
           ViewContext.RouteData.Values["action"]?.ToString() == "Search"
           ? "active" : "")"
           asp-action="Index" asp-controller="OPD">Main</a>

        <a class="btn btn-outline-dark @(ViewContext.RouteData.Values["action"]?.ToString() == "Reports" ? "active" : "")"
           asp-action="Reports" asp-controller="OPD">Reports</a>

        <a class="btn btn-outline-dark @(
                ViewContext.RouteData.Values["action"]?.ToString() == "Statistics" ||
                ViewContext.RouteData.Values["action"]?.ToString() == "SortByStatistics" ||
                ViewContext.RouteData.Values["action"]?.ToString() == "EditStatistics" 
                ? "active" : "")"
           asp-action="Statistics" asp-controller="OPD">Statistics</a>
    </div>
</div>
<hr />

<!-- Back to List -->
<div class="mt-2">
    <a class="btn btn-outline-secondary mb-3" asp-controller="OPD" asp-action="Index">← Back to List</a>
</div>

<div class="d-flex justify-content-between align-items-start flex-wrap gap-2 mb-3">
    @* Left toggles/buttons *@
    <div class="d-flex align-items-center gap-3">
        <a class="btn btn-success hide-when-archived" asp-action="EditStatistics" asp-controller="OPD">
            <i class="bx bx-edit"></i> Edit Your Statistics (@User.FindFirst(System.Security.Claims.ClaimTypes.Name).Value)
        </a>
    </div>

    @* Right toggles/buttons *@
    <div class="btn-group">
        <button type="button" class="btn btn-outline-secondary btn-sm dropdown-toggle d-flex align-items-center gap-1 me-2" data-bs-toggle="dropdown" aria-expanded="false">
            @if (string.IsNullOrEmpty(sortBy))
            {
                <span class="mb-0">Filter by MSW</span>
            }
            else
            {
                <span class="mb-0">@sortBy</span>
            }
        </button>
        <ul class="dropdown-menu dropdown-menu-end">
            <li>
                <a class="dropdown-item" asp-action="SortByStatistics"
                   asp-controller="OPD" asp-route-sortByUserID="" asp-route-sortByMonth="@sortByMonth"
                   asp-route-viewName="Statistics">All</a>
            </li>
            @foreach (var user in Model.Users)
            {
                <li>
                    <a class="dropdown-item" asp-action="SortByStatistics"
                       asp-controller="OPD" asp-route-sortByUserID="@user.UserID" asp-route-sortByMonth="@sortByMonth"
                       asp-route-viewName="Statistics">@user.Username</a>
                </li>
            }
        </ul>
        @* @if (matchedUser)
        {
            foreach (var user in Model.Users)
            {
                if (user.Username == sortBy)
                {
                    <a class="btn btn-sm btn-success" style="margin-left:5px;"
                       asp-action="ExportLogsheetToExcel"
                       asp-route-userID="@user.UserID">
                        Download Excel (@user.Username)
                    </a>
                }
            }
        }
        else
        {
            <a class="btn btn-sm btn-success" style="margin-left:5px;"
               asp-action="ExportLogsheetToExcel">
                Download Excel (All)
            </a>
        } *@

        @* Month filter *@
        <form method="get" asp-action="SortByStatistics" class="d-flex align-items-center gap-2">
            <input type="hidden" name="sortByUserID" value="@sortByUserID" />
            <input type="hidden" name="viewName" value="Statistics" />
            <input type="month" name="sortByMonth" class="form-control form-control-sm" value="@sortByMonth" />
            <button type="submit" class="btn btn-secondary btn-sm" style="width: 100%;">
                <i class="bi bi-filter"></i> Filter Month
            </button>
        </form>

        <button type="button" class="btn btn-success btn-sm" style="margin-left:5px;"
                data-bs-toggle="modal"
                data-bs-target="#exportModal"
                data-bs-toggle="tooltip"
                title="Download Excel">
            <i class="bi bi-file-earmark-arrow-down"></i> Download Excel
        </button>

        <!-- Download/Export Excel Modal -->
        <div class="modal fade" id="exportModal" tabindex="-1" aria-labelledby="exportModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <form asp-action="ExportOPDStatisticsToExcel" asp-controller="OPD" method="get">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exportModalLabel">Export to Excel</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>

                        <div class="modal-body">
                            <div class="mb-3">
                                <label for="userID" class="form-label">MSW</label>
                                <select class="form-select" id="userID" name="userID">
                                    <option value="0">All</option>
                                    @foreach (var user in Model.Users)
                                    {
                                        <option value="@user.UserID">@user.Username</option>
                                    }
                                </select>
                            </div>

                            <div class="mb-3">
                                <label for="month" class="form-label">Month</label>
                                <input type="month" id="month" name="month" class="form-control">
                                <div class="form-text">Leave empty for "All Time"</div>
                            </div>
                        </div>

                        <div class="modal-footer">
                            <button type="submit" class="btn btn-success">Export</button>
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

    </div>

</div>

@if (TempData["SuccessMessage"] != null)
{
    <div class="alert alert-success alert-dismissible fade show" role="alert" style="width: 60%;">
        @TempData["SuccessMessage"]
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}
@if (TempData["ErrorMessage"] != null)
{
    <div class="alert alert-danger alert-dismissible fade show" role="alert" style="width: 60%;">
        @TempData["ErrorMessage"]
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}

@if (string.IsNullOrEmpty(sortBy))
{
    <h4 style="margin-top: 15px;">All MSW</h4>
}
else
{
    <h4 style="margin-top: 15px;">@sortBy</h4>
}

<div class="container-fluid px-0 mx-0" style="max-width: 1600px;">
    <div class="table-responsive" style="overflow-x: auto;">
        <table class="table" style="min-width: 1200px;">
            <thead>
                @if (Model != null)
                {
                    <tr>
                        <th style="white-space: nowrap; font-weight: bold; text-align:center;">MONTH</th>
                        <th>JAN</th>
                        <th>FEB</th>
                        <th>MARCH</th>
                        <th>APRIL</th>
                        <th>MAY</th>
                        <th>JUNE</th>
                        <th>TOTAL</th>
                        <th>JULY</th>
                        <th>AUG</th>
                        <th>SEPT</th>
                        <th>OCT</th>
                        <th>NOV</th>
                        <th>DEC</th>
                        <th>TOTAL</th>
                    </tr>
                }
            </thead>
            <tbody>
                @if (Model != null)
                {
                    <tr>
                        <td style="white-space: nowrap; font-weight: bold;">I. SOURCE OF REFERRAL</td>
                        @for (int i = 1; i <= 14; i++)
                        {
                            if (i == 7 || i == 14)
                            {
                                <td style="white-space: nowrap;">0</td>
                            }
                            else
                            {
                                <td style="white-space: nowrap;"></td>
                            }
                        }
                    </tr>

                    <tr>
                        <td style="white-space: nowrap;">Referring Party</td>
                        @for (int i = 1; i <= 14; i++)
                        {
                            if (i == 7 || i == 14)
                            {
                                <td style="white-space: nowrap;">0</td>
                            }
                            else
                            {
                                <td style="white-space: nowrap;"></td>
                            }
                        }
                    </tr>

                    var sourceOfReferral = new Dictionary<string, string>
                    {
                                { "1. Government Hospital", "Govt. Hosp." },
                                { "2. Private Hospital", "Private/Clinic" },
                                { "3. Politicians", "Politicians" },
                                { "4. Media", "Media" },
                                { "5. Health Care Team", "Health Care Team" },
                                { "6. NGOs/Private Welfare Agencies", "NGO/Private Welfare" },
                                { "7. Government Agencies (DSWD, DOH Officials)", "Govt. Agencies" },
                                { "8. Walk-in", "Walk in" },
                                { "9. Others (employers, former pts, colleagues, friends)", "Others" },

					};

                    @foreach (var source in sourceOfReferral)
                    {
						var key = source.Key;
						var value = source.Value;

                        <tr>
                            <td style="white-space: nowrap;">@key</td>
                        
                            @for (int i = 1; i <= 6; i++)
                            {
                                var count = Model.OPDList.Count(m => m.SourceOfReferral.Equals(value, StringComparison.OrdinalIgnoreCase) && m.Date.Month == i);
                                <td style="white-space: nowrap;">@(count == 0 ? "" : count)</td>
                            }

                            <td style="white-space: nowrap;">
                                @(Enumerable.Range(1, 6).Sum(i => Model.OPDList.Count(m => m.SourceOfReferral.Equals(value, StringComparison.OrdinalIgnoreCase) && m.Date.Month == i)))
                            </td>

                            @for (int i = 7; i <= 12; i++)
                            {
                                var count = Model.OPDList.Count(m => m.SourceOfReferral.Equals(value, StringComparison.OrdinalIgnoreCase) && m.Date.Month == i);
                                <td style="white-space: nowrap;">@(count == 0 ? "" : count)</td>
                            }

                            <td style="white-space: nowrap;">
                                @(Enumerable.Range(7, 6).Sum(i => Model.OPDList.Count(m => m.SourceOfReferral.Equals(value, StringComparison.OrdinalIgnoreCase) && m.Date.Month == i)))
                            </td>
                        </tr>
					}

                    <tr>
                        <td style="white-space: nowrap; font-weight: bold; text-align:center;">TOTAL</td>

                        @for (int i = 1; i <= 6; i++)
                        {
                            <td style="white-space: nowrap; font-weight: bold;">@Model.TotalSourcesMonthly[i]</td>
                        }

                        <td style="white-space: nowrap; font-weight: bold;">
                            @(Enumerable.Range(1, 6).Sum(i => Model.TotalSourcesMonthly[i]))
                        </td>

                        @for (int i = 7; i <= 12; i++)
                        {
                            <td style="white-space: nowrap; font-weight: bold;">@Model.TotalSourcesMonthly[i]</td>
                        }

                        <td style="white-space: nowrap; font-weight: bold;">
                            @(Enumerable.Range(7, 6).Sum(i => Model.TotalSourcesMonthly[i]))
                        </td>
                    </tr>

                    <tr>
                        <td style="white-space: nowrap; font-weight: bold;">II. CASELOAD ACCORDING TO SERVICES</td>
                        @for (int i = 1; i <= 14; i++)
                        {
                            if (i == 7 || i == 14)
                            {
                                <td style="white-space: nowrap;">0</td>
                            }
                            else
                            {
                                <td style="white-space: nowrap;"></td>
                            }
                        }
                    </tr>

                    <tr>
                        <td style="white-space: nowrap;">1. During Census</td>
                        @for (int i = 1; i <= 14; i++)
                        {
                            if (i == 7 || i == 14)
                            {
                                <td style="white-space: nowrap;">0</td>
                            }
                            else
                            {
                                <td style="white-space: nowrap;"></td>
                            }
                        }
                    </tr>

                    <tr>
                        <td style="white-space: nowrap;">1.1 New Cases</td>

                        @for (int i = 1; i <= 6; i++)
                        {
                            var count = Model.OPDList.Count(m => !m.IsOld && m.Date.Month == i);
                            <td style="white-space: nowrap;">@(count == 0 ? "" : count)</td>
                        }

                        <td style="white-space: nowrap;">
                            @(Enumerable.Range(1, 6).Sum(i => Model.OPDList.Count(m => !m.IsOld && m.Date.Month == i)))
                        </td>

                        @for (int i = 7; i <= 12; i++)
                        {
                            var count = Model.OPDList.Count(m => !m.IsOld && m.Date.Month == i);
                            <td style="white-space: nowrap;">@(count == 0 ? "" : count)</td>
                        }

                        <td style="white-space: nowrap;">
                            @(Enumerable.Range(7, 6).Sum(i => Model.OPDList.Count(m => !m.IsOld && m.Date.Month == i)))
                        </td>
                    </tr>

                    <tr>
                        <td style="white-space: nowrap;">1.2 Old Cases</td>

                        @for (int i = 1; i <= 6; i++)
                        {
                            var count = Model.OPDList.Count(m => m.IsOld && m.Date.Month == i);
                            <td style="white-space: nowrap;">@(count == 0 ? "" : count)</td>
                        }

                        <td style="white-space: nowrap;">
                            @(Enumerable.Range(1, 6).Sum(i => Model.OPDList.Count(m => m.IsOld && m.Date.Month == i)))
                        </td>

                        @for (int i = 7; i <= 12; i++)
                        {
                            var count = Model.OPDList.Count(m => m.IsOld && m.Date.Month == i);
                            <td style="white-space: nowrap;">@(count == 0 ? "" : count)</td>
                        }

                        <td style="white-space: nowrap;">
                            @(Enumerable.Range(7, 6).Sum(i => Model.OPDList.Count(m => m.IsOld && m.Date.Month == i)))
                        </td>
                    </tr>

                    <tr>
                        <td style="white-space: nowrap;">2. Closed Summary</td>
                        @for (int i = 1; i <= 14; i++)
                        {
                            if (i == 7 || i == 14)
                            {
                                <td style="white-space: nowrap;">0</td>
                            }
                            else
                            {
                                <td style="white-space: nowrap;"></td>
                            }
                        }
                    </tr>

                    <tr>
                        <td style="white-space: nowrap;">3. Number of patients based on sectoral groupings mandated by law/policies:</td>
                        @for (int i = 1; i <= 14; i++)
                        {
                            if (i == 7 || i == 14)
                            {
                                <td style="white-space: nowrap;">0</td>
                            }
                            else
                            {
                                <td style="white-space: nowrap;"></td>
                            }
                        }
                    </tr>

                    <tr>
                        <td style="white-space: nowrap;">a. PWD</td>

                        @for (int i = 1; i <= 6; i++)
                        {
                            var count = Model.OPDList.Count(m => m.IsPWD && m.Date.Month == i);
                            <td style="white-space: nowrap;">@(count == 0 ? "" : count)</td>
                        }

                        <td style="white-space: nowrap;">
                            @(Enumerable.Range(1, 6).Sum(i => Model.OPDList.Count(m => m.IsPWD && m.Date.Month == i)))
                        </td>

                        @for (int i = 7; i <= 12; i++)
                        {
                            var count = Model.OPDList.Count(m => m.IsPWD && m.Date.Month == i);
                            <td style="white-space: nowrap;">@(count == 0 ? "" : count)</td>
                        }

                        <td style="white-space: nowrap;">
                            @(Enumerable.Range(7, 6).Sum(i => Model.OPDList.Count(m => m.IsPWD && m.Date.Month == i)))
                        </td>
                    </tr>

                    <tr>
                        <td style="white-space: nowrap;">b. Indigenous People</td>
                        @for (int i = 1; i <= 14; i++)
                        {
                            if (i == 7 || i == 14)
                            {
                                <td style="white-space: nowrap;">0</td>
                            }
                            else
                            {
                                <td style="white-space: nowrap;"></td>
                            }
                        }
                    </tr>

                    <tr>
                        <td style="white-space: nowrap;">c. Government Workers</td>
                        @for (int i = 1; i <= 14; i++)
                        {
                            if (i == 7 || i == 14)
                            {
                                <td style="white-space: nowrap;">0</td>
                            }
                            else
                            {
                                <td style="white-space: nowrap;"></td>
                            }
                        }
                    </tr>

                    <tr>
                        <td style="white-space: nowrap; font-weight: bold;">SERVICES</td>
                        @for (int i = 1; i <= 14; i++)
                        {
                            if (i == 7 || i == 14)
                            {
                                <td style="white-space: nowrap;">0</td>
                            }
                            else
                            {
                                <td style="white-space: nowrap;"></td>
                            }
                        }
                    </tr>

                    <tr>
                        <td style="white-space: nowrap; font-weight: bold;">1. Planning, Screening and Eligibility Study / PSE</td>
                        @for (int i = 1; i <= 14; i++)
                        {
                            if (i == 7 || i == 14)
                            {
                                <td style="white-space: nowrap;">0</td>
                            }
                            else
                            {
                                <td style="white-space: nowrap;"></td>
                            }
                        }
                    </tr>

                    <tr>
                        <td style="white-space: nowrap;">1.1 Socio Economic Classification</td>
                        @for (int i = 1; i <= 14; i++)
                        {
                            if (i == 7 || i == 14)
                            {
                                <td style="white-space: nowrap;">0</td>
                            }
                            else
                            {
                                <td style="white-space: nowrap;"></td>
                            }
                        }
                    </tr>

                    <tr>
                        <td style="white-space: nowrap;">1.2 Pre-admission Planning</td>
                        @for (int i = 1; i <= 14; i++)
                        {
                            if (i == 7 || i == 14)
                            {
                                <td style="white-space: nowrap;">0</td>
                            }
                            else
                            {
                                <td style="white-space: nowrap;"></td>
                            }
                        }
                    </tr>

                    <tr>
                        <td style="white-space: nowrap;">1.3 Information Services/Orientation</td>
                        @for (int i = 1; i <= 14; i++)
                        {
                            if (i == 7 || i == 14)
                            {
                                <td style="white-space: nowrap;">0</td>
                            }
                            else
                            {
                                <td style="white-space: nowrap;"></td>
                            }
                        }
                    </tr>

                    <tr>
                        <td style="white-space: nowrap; font-weight: bold;">2. Concrete and Referral Services</td>
                        @for (int i = 1; i <= 14; i++)
                        {
                            if (i == 7 || i == 14)
                            {
                                <td style="white-space: nowrap;">0</td>
                            }
                            else
                            {
                                <td style="white-space: nowrap;"></td>
                            }
                        }
                    </tr>

                    <tr>
                        <td style="white-space: nowrap;">2.1 Provision of Discount</td>
                        @for (int i = 1; i <= 14; i++)
                        {
                            if (i == 7 || i == 14)
                            {
                                <td style="white-space: nowrap;">0</td>
                            }
                            else
                            {
                                <td style="white-space: nowrap;"></td>
                            }
                        }
                    </tr>

                    <tr>
                        <td style="white-space: nowrap;">2.2 Facilitating Referrals</td>
                        @for (int i = 1; i <= 14; i++)
                        {
                            if (i == 7 || i == 14)
                            {
                                <td style="white-space: nowrap;">0</td>
                            }
                            else
                            {
                                <td style="white-space: nowrap;"></td>
                            }
                        }
                    </tr>

                    <tr>
                        <td style="white-space: nowrap;">2.2.1 Outgoing Referrals for:</td>
                        @for (int i = 1; i <= 14; i++)
                        {
                            if (i == 7 || i == 14)
                            {
                                <td style="white-space: nowrap;">0</td>
                            }
                            else
                            {
                                <td style="white-space: nowrap;"></td>
                            }
                        }
                    </tr>

                    var outgoingReferrals = new List<string>
                    {
                        "a. Medical Assistance",
                        "b. Discount on Procedure/Hospital Expenses",
                        "c. Transportation Fare",
                        "d. Institutional Placement",
                        "e. Temporary Shelter",
                        "f. Funeral Assistance/Pauper's Burial",
                        "g. Others specify (networking)"
                    };

                    foreach (var value in outgoingReferrals)
                    {
                        <tr>
                            <td style="white-space: nowrap;">@value</td>
                            @for (int i = 1; i <= 14; i++)
                            {
                                if (i == 7 || i == 14)
                                {
                                    <td style="white-space: nowrap;">0</td>
                                }
                                else
                                {
                                    <td style="white-space: nowrap;"></td>
                                }
                            }
                        </tr>
                    }

                    <tr>
                        <td style="white-space: nowrap;">2.2.2 Incoming Referrals</td>
                        @for (int i = 1; i <= 14; i++)
                        {
                            if (i == 7 || i == 14)
                            {
                                <td style="white-space: nowrap;">0</td>
                            }
                            else
                            {
                                <td style="white-space: nowrap;"></td>
                            }
                        }
                    </tr>

                    <tr>
                        <td style="white-space: nowrap; font-weight: bold;">3. Psychosocial Counseling</td>
                        @for (int i = 1; i <= 14; i++)
                        {
                            if (i == 7 || i == 14)
                            {
                                <td style="white-space: nowrap;">0</td>
                            }
                            else
                            {
                                <td style="white-space: nowrap;"></td>
                            }
                        }
                    </tr>

                    <tr>
                        <td style="white-space: nowrap;">Ten Leading Causes for Counselling</td>
                        @for (int i = 1; i <= 14; i++)
                        {
                            if (i == 7 || i == 14)
                            {
                                <td style="white-space: nowrap;">0</td>
                            }
                            else
                            {
                                <td style="white-space: nowrap;"></td>
                            }
                        }
                    </tr>

                    var tenLeadingCauses = new List<string>
                    {
                        "1. Stress of the family",
                        "2. Refusal of patient to take home",
                        "3. Anxiety of health cost",
                        "4. Marital problem",
                        "5. Refusal of patient for treatment",
                        "6. Unbecoming attitude due to postponement if surgery",
                        "7. Emotional problem",
                        "8. Neglected children",
                        "9. Sexually abuse",
                        "10. Adjustment problem"
                    };

                    foreach (var value in tenLeadingCauses)
                    {
                        <tr>
                            <td style="white-space: nowrap;">@value</td>
                            @for (int i = 1; i <= 14; i++)
                            {
                                if (i == 7 || i == 14)
                                {
                                    <td style="white-space: nowrap;">0</td>
                                }
                                else
                                {
                                    <td style="white-space: nowrap;"></td>
                                }
                            }
                        </tr>
                    }

                    <tr>
                        <td style="white-space: nowrap;">3.2 Family Counselling</td>
                        @for (int i = 1; i <= 14; i++)
                        {
                            if (i == 7 || i == 14)
                            {
                                <td style="white-space: nowrap;">0</td>
                            }
                            else
                            {
                                <td style="white-space: nowrap;"></td>
                            }
                        }
                    </tr>

                    var familyCounseling = new List<string>
                    {
                        "a. Social Worker",
                        "b. Health Care Team"
                    };

                    foreach (var value in familyCounseling)
                    {
                        <tr>
                            <td style="white-space: nowrap;">@value</td>
                            @for (int i = 1; i <= 14; i++)
                            {
                                if (i == 7 || i == 14)
                                {
                                    <td style="white-space: nowrap;">0</td>
                                }
                                else
                                {
                                    <td style="white-space: nowrap;"></td>
                                }
                            }
                        </tr>
                    }

                    var psychologicalCounseling = new List<string>
                    {
                        "3.3 Psychosocial Crisis Intervention",
                        "3.4 Group Work/Per Session",
                        "3.5 Patients/Watchers Education",
                        "3.6 Mutual Support Group Session",
                        "3.7 Advocacy Group"
                    };

                    foreach (var value in psychologicalCounseling)
                    {
                        <tr>
                            <td style="white-space: nowrap;">@value</td>
                            @for (int i = 1; i <= 14; i++)
                            {
                                if (i == 7 || i == 14)
                                {
                                    <td style="white-space: nowrap;">0</td>
                                }
                                else
                                {
                                    <td style="white-space: nowrap;"></td>
                                }
                            }
                        </tr>
                    }

                    <tr>
                        <td style="white-space: nowrap; font-weight: bold;">4. Discharges Services</td>
                        @for (int i = 1; i <= 14; i++)
                        {
                            if (i == 7 || i == 14)
                            {
                                <td style="white-space: nowrap;">0</td>
                            }
                            else
                            {
                                <td style="white-space: nowrap;"></td>
                            }
                        }
                    </tr>

                    var dischargesServices = new List<string>
                    {
                        "a. Discharge Planning",
                        "b. Facilitation of Discharge",
                        "c. Pre-termination Counseling",
                        "d. Home Conduction"
                    };

                    foreach (var value in dischargesServices)
                    {
                        <tr>
                            <td style="white-space: nowrap;">@value</td>
                            @for (int i = 1; i <= 14; i++)
                            {
                                if (i == 7 || i == 14)
                                {
                                    <td style="white-space: nowrap;">0</td>
                                }
                                else
                                {
                                    <td style="white-space: nowrap;"></td>
                                }
                            }
                        </tr>
                    }

                    <tr>
                        <td style="white-space: nowrap; font-weight: bold;">5. Support Services</td>
                        @for (int i = 1; i <= 14; i++)
                        {
                            if (i == 7 || i == 14)
                            {
                                <td style="white-space: nowrap;">0</td>
                            }
                            else
                            {
                                <td style="white-space: nowrap;"></td>
                            }
                        }
                    </tr>

                    <tr>
                        <td style="white-space: nowrap;">5.1 Ward Visitation</td>
                        @for (int i = 1; i <= 14; i++)
                        {
                            if (i == 7 || i == 14)
                            {
                                <td style="white-space: nowrap;">0</td>
                            }
                            else
                            {
                                <td style="white-space: nowrap;"></td>
                            }
                        }
                    </tr>

                    var wardVisitation = new List<string>
                    {
                        "a. Individual",
                        "b. Team"
                    };

                    foreach (var value in wardVisitation)
                    {
                        <tr>
                            <td style="white-space: nowrap;">@value</td>
                            @for (int i = 1; i <= 14; i++)
                            {
                                if (i == 7 || i == 14)
                                {
                                    <td style="white-space: nowrap;">0</td>
                                }
                                else
                                {
                                    <td style="white-space: nowrap;"></td>
                                }
                            }
                        </tr>
                    }

                    <tr>
                        <td style="white-space: nowrap; font-weight: bold;">6. Case Conferences</td>
                        @for (int i = 1; i <= 14; i++)
                        {
                            if (i == 7 || i == 14)
                            {
                                <td style="white-space: nowrap;">0</td>
                            }
                            else
                            {
                                <td style="white-space: nowrap;"></td>
                            }
                        }
                    </tr>

                    var caseConferences = new List<string>
                    {
                        "a. Multi Disciplinary",
                        "b. MSWD"
                    };

                    foreach (var value in caseConferences)
                    {
                        <tr>
                            <td style="white-space: nowrap;">@value</td>
                            @for (int i = 1; i <= 14; i++)
                            {
                                if (i == 7 || i == 14)
                                {
                                    <td style="white-space: nowrap;">0</td>
                                }
                                else
                                {
                                    <td style="white-space: nowrap;"></td>
                                }
                            }
                        </tr>
                    }

                    <tr>
                        <td style="white-space: nowrap; font-weight: bold;">7. Follow-up Services</td>
                        @for (int i = 1; i <= 14; i++)
                        {
                            if (i == 7 || i == 14)
                            {
                                <td style="white-space: nowrap;">0</td>
                            }
                            else
                            {
                                <td style="white-space: nowrap;"></td>
                            }
                        }
                    </tr>

                    var followUpServices = new List<string>
                    {
                        "7.1 Home Visit",
                        "7.2 Letters Sent",
                        "7.3 Contact of Relatives by Telephone",
                        "7.4 Contact of Relatives through Mass Media"
                    };

                    foreach (var value in followUpServices)
                    {
                        <tr>
                            <td style="white-space: nowrap;">@value</td>
                            @for (int i = 1; i <= 14; i++)
                            {
                                if (i == 7 || i == 14)
                                {
                                    <td style="white-space: nowrap;">0</td>
                                }
                                else
                                {
                                    <td style="white-space: nowrap;"></td>
                                }
                            }
                        </tr>
                    }

                    <tr>
                        <td style="white-space: nowrap; font-weight: bold;">8. Coordination/Initiated by MSW</td>
                        @for (int i = 1; i <= 14; i++)
                        {
                            if (i == 7 || i == 14)
                            {
                                <td style="white-space: nowrap;">0</td>
                            }
                            else
                            {
                                <td style="white-space: nowrap;"></td>
                            }
                        }
                    </tr>

                    var coordinationsByMSW = new List<string>
                    {
                        "a. Physicians",
                        "b. Nurses",
                        "c. Pharmacist",
                        "d. Nutritionist",
                        "e. Other Staff",
                        "f. Management"
                    };

                    foreach (var value in coordinationsByMSW)
                    {
                        <tr>
                            <td style="white-space: nowrap;">@value</td>
                            @for (int i = 1; i <= 14; i++)
                            {
                                if (i == 7 || i == 14)
                                {
                                    <td style="white-space: nowrap;">0</td>
                                }
                                else
                                {
                                    <td style="white-space: nowrap;"></td>
                                }
                            }
                        </tr>
                    }

                    <tr>
                        <td style="white-space: nowrap; font-weight: bold;">9. Consultative and Advisory Services</td>
                        @for (int i = 1; i <= 14; i++)
                        {
                            if (i == 7 || i == 14)
                            {
                                <td style="white-space: nowrap;">0</td>
                            }
                            else
                            {
                                <td style="white-space: nowrap;"></td>
                            }
                        }
                    </tr>

                    var consultatives = new List<string>
                    {
                        "a. Physicians",
                        "b. Office Staff",
                        "c. Outside Hospital"
                    };

                    foreach (var value in consultatives)
                    {
                        <tr>
                            <td style="white-space: nowrap;">@value</td>
                            @for (int i = 1; i <= 14; i++)
                            {
                                if (i == 7 || i == 14)
                                {
                                    <td style="white-space: nowrap;">0</td>
                                }
                                else
                                {
                                    <td style="white-space: nowrap;"></td>
                                }
                            }
                        </tr>
                    }

                    <tr>
                        <td style="white-space: nowrap; font-weight: bold;">10. Community Outreach</td>
                        @for (int i = 1; i <= 14; i++)
                        {
                            if (i == 7 || i == 14)
                            {
                                <td style="white-space: nowrap;">0</td>
                            }
                            else
                            {
                                <td style="white-space: nowrap;"></td>
                            }
                        }
                    </tr>

                    <tr>
                        <td style="white-space: nowrap; font-weight: bold;">III. CASE MANAGEMENT SERVICES</td>
                        @for (int i = 1; i <= 14; i++)
                        {
                            if (i == 7 || i == 14)
                            {
                                <td style="white-space: nowrap;">0</td>
                            }
                            else
                            {
                                <td style="white-space: nowrap;"></td>
                            }
                        }
                    </tr>

                    var caseManagements = new List<string>
                    {
                        "1.1 Pre admission Counselling",
                        "1.2 Intake Interview",
                        "1.3 Collateral Interview",
                        "1.4 Issuance of MSS Card",
                        "1.5 Indicate classification in the chart (in pts only)",
                        "1.6 Psychosocial Assessment",
                        "1.7 Psychosocial Counselling",
                        "1.8 Coordination w/ Multidiciplinary Team",
                        "1.9 Completion of Intake Form",
                        "1.10 Health Education",
                        "1.11 Crisis Intervention",
                        "1.12 Concrete Services"
                    };

                    foreach (var value in caseManagements)
                    {
                        <tr>
                            <td style="white-space: nowrap;">@value</td>
                            @for (int i = 1; i <= 14; i++)
                            {
                                if (i == 7 || i == 14)
                                {
                                    <td style="white-space: nowrap;">0</td>
                                }
                                else
                                {
                                    <td style="white-space: nowrap;"></td>
                                }
                            }
                        </tr>
                    }

                    var concreteServices = new List<string>
                    {
                        "1.12.1 Facilitaion/Provision of Meds/Procedures",
                        "1.12.2 Transportation Assistance (w/in MSS resources)",
                        "1.12.3 Material Assistance (food, clothing)",
                        "1.12.4 Financial Assistance (w/in MSS resources)"
                    };

                    foreach (var value in concreteServices)
                    {
                        <tr>
                            <td style="white-space: nowrap;">@value</td>
                            @for (int i = 1; i <= 14; i++)
                            {
                                if (i == 7 || i == 14)
                                {
                                    <td style="white-space: nowrap;">0</td>
                                }
                                else
                                {
                                    <td style="white-space: nowrap;"></td>
                                }
                            }
                        </tr>
                    }

                    <tr>
                        <td style="white-space: nowrap;">1.13 Referral</td>
                        @for (int i = 1; i <= 14; i++)
                        {
                            if (i == 7 || i == 14)
                            {
                                <td style="white-space: nowrap;">0</td>
                            }
                            else
                            {
                                <td style="white-space: nowrap;"></td>
                            }
                        }
                    </tr>

                    var referralServices = new List<string>
                    {
                        "1.13.1 Facilitating Incoming Referral",
                        "1.13.2 Preparing the Referral",
                        "1.13.3 Coordination w/ the Receiveing Agency"
                    };

                    foreach (var value in referralServices)
                    {
                        <tr>
                            <td style="white-space: nowrap;">@value</td>
                            @for (int i = 1; i <= 14; i++)
                            {
                                if (i == 7 || i == 14)
                                {
                                    <td style="white-space: nowrap;">0</td>
                                }
                                else
                                {
                                    <td style="white-space: nowrap;"></td>
                                }
                            }
                        </tr>
                    }

                    var caseManagements2 = new List<string>
                    {
                        "1.14 Ward Rounds (no. of pts visited)",
                        "1.15 Home Visitation",
                        "1.16 Advocacy Role",
                        "1.17 Education",
                        "1.18 Therapeutic Social Work Services"
                    };

                    foreach (var value in caseManagements2)
                    {
                        <tr>
                            <td style="white-space: nowrap;">@value</td>
                            @for (int i = 1; i <= 14; i++)
                            {
                                if (i == 7 || i == 14)
                                {
                                    <td style="white-space: nowrap;">0</td>
                                }
                                else
                                {
                                    <td style="white-space: nowrap;"></td>
                                }
                            }
                        </tr>
                    }

                    var therapeuticServices = new List<string>
                    {
                        "1.18.1 Abandoned",
                        "1.18.2 Sexually Abused",
                        "1.18.3 Neglected",
                        "1.18.4 Battered"
                    };

                    foreach (var value in therapeuticServices)
                    {
                        <tr>
                            <td style="white-space: nowrap;">@value</td>
                            @for (int i = 1; i <= 14; i++)
                            {
                                if (i == 7 || i == 14)
                                {
                                    <td style="white-space: nowrap;">0</td>
                                }
                                else
                                {
                                    <td style="white-space: nowrap;"></td>
                                }
                            }
                        </tr>
                    }

                    var caseManagements3 = new List<string>
                    {
                        "1.19 Protective Services",
                        "1.20 Grief Work",
                        "1.21 Behavioral Modification ",
                        "1.22 Networking (meeting w/ other institution/grp org.)",
                        "1.23 Politicians",
                        "1.24 Coordination w/ Mass Media",
                        "1.25 Consultaion/Advisory Services",
                        "1.26 Attendance to Case Conferences Committee Meetings",
                        "1.27 Attendance to Clinical Comittees"
                    };

                    foreach (var value in caseManagements3)
                    {
                        <tr>
                            <td style="white-space: nowrap;">@value</td>
                            @for (int i = 1; i <= 14; i++)
                            {
                                if (i == 7 || i == 14)
                                {
                                    <td style="white-space: nowrap;">0</td>
                                }
                                else
                                {
                                    <td style="white-space: nowrap;"></td>
                                }
                            }
                        </tr>
                    }

                    var attendances = new List<string>
                    {
                        "1.27.1 Disharge Planning",
                        "1.27.2 Facilitation of Discharge",
                        "1.27.3 Home Conduction"
                    };

                    foreach (var value in attendances)
                    {
                        <tr>
                            <td style="white-space: nowrap;">@value</td>
                            @for (int i = 1; i <= 14; i++)
                            {
                                if (i == 7 || i == 14)
                                {
                                    <td style="white-space: nowrap;">0</td>
                                }
                                else
                                {
                                    <td style="white-space: nowrap;"></td>
                                }
                            }
                        </tr>
                    }

                    var caseManagements4 = new List<string>
                    {
                        "1.28 Follow up Services",
                        "1.29 Documentation"
                    };

                    foreach (var value in caseManagements4)
                    {
                        <tr>
                            <td style="white-space: nowrap;">@value</td>
                            @for (int i = 1; i <= 14; i++)
                            {
                                if (i == 7 || i == 14)
                                {
                                    <td style="white-space: nowrap;">0</td>
                                }
                                else
                                {
                                    <td style="white-space: nowrap;"></td>
                                }
                            }
                        </tr>
                    }

                    var documentations = new List<string>
                    {
                        "1.29.1 Profile",
                        "1.29.2 Progress Notes",
                        "1.29.3 Groupwork Recording",
                        "1.29.4 Social Case Study Report/Social Case Summary",
                        "1.29.5 Home Visit Report"
                    };

                    foreach (var value in documentations)
                    {
                        <tr>
                            <td style="white-space: nowrap;">@value</td>
                            @for (int i = 1; i <= 14; i++)
                            {
                                if (i == 7 || i == 14)
                                {
                                    <td style="white-space: nowrap;">0</td>
                                }
                                else
                                {
                                    <td style="white-space: nowrap;"></td>
                                }
                            }
                        </tr>
                    }

                    var caseManagements5 = new List<string>
                    {
                        "1.30 Palliative Care",
                        "1.31 Facilitation of Unclaimed Cadaver",
                        "1.32 Post Discharge Services",
                        "1.33 Follow up Services through text/phone",
                        "1.34 Follow up Treatment Plans",
                        "1.35 Follow up of Rehabilitation Plans",
                        "1.36 Rehabilitation Services"
                    };

                    foreach (var value in caseManagements5)
                    {
                        <tr>
                            <td style="white-space: nowrap;">@value</td>
                            @for (int i = 1; i <= 14; i++)
                            {
                                if (i == 7 || i == 14)
                                {
                                    <td style="white-space: nowrap;">0</td>
                                }
                                else
                                {
                                    <td style="white-space: nowrap;"></td>
                                }
                            }
                        </tr>
                    }

                    var rehabilitationServices = new List<string>
                    {
                        "1.36.1 Skills Training",
                        "1.36.2 Job Placement",
                        "1.36.3 Capital Assistance"
                    };

                    foreach (var value in rehabilitationServices)
                    {
                        <tr>
                            <td style="white-space: nowrap;">@value</td>
                            @for (int i = 1; i <= 14; i++)
                            {
                                if (i == 7 || i == 14)
                                {
                                    <td style="white-space: nowrap;">0</td>
                                }
                                else
                                {
                                    <td style="white-space: nowrap;"></td>
                                }
                            }
                        </tr>
                    }

                    var caseManagements6 = new List<string>
                    {
                        "1.37 MSWD Fund Raising Activity",
                        "1.38 Hospital Activity",
                        "1.39 Linkage w/ Donors"
                    };

                    foreach (var value in caseManagements6)
                    {
                        <tr>
                            <td style="white-space: nowrap;">@value</td>
                            @for (int i = 1; i <= 14; i++)
                            {
                                if (i == 7 || i == 14)
                                {
                                    <td style="white-space: nowrap;">0</td>
                                }
                                else
                                {
                                    <td style="white-space: nowrap;"></td>
                                }
                            }
                        </tr>
                    }

                    <tr>
                        <td style="white-space: nowrap; font-weight: bold; text-align:center;">TOTAL</td>

                        @for (int i = 1; i <= 6; i++)
                        {
                            <td style="white-space: nowrap; font-weight: bold;">
                                @(Model.TotalCaseloadMonthly[i] + Model.TotalStatisticsMonthly[i].Values.Sum())
                            </td>
                        }

                        <td style="white-space: nowrap; font-weight: bold;">
                            @(Enumerable.Range(1, 6).Sum(i => Model.TotalCaseloadMonthly[i] + Model.TotalStatisticsMonthly[i].Values.Sum()))
                        </td>

                        @for (int i = 7; i <= 12; i++)
                        {
                            <td style="white-space: nowrap; font-weight: bold;">
                                @(Model.TotalCaseloadMonthly[i] + Model.TotalStatisticsMonthly[i].Values.Sum())
                            </td>
                        }

                        <td style="white-space: nowrap; font-weight: bold;">
                            @(Enumerable.Range(7, 6).Sum(i => Model.TotalCaseloadMonthly[i] + Model.TotalStatisticsMonthly[i].Values.Sum()))
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>
