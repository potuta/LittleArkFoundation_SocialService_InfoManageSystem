@{
    ViewData["Title"] = "Reset Password";
    Layout = "_LoginLayout";
}

@* <h1>Reset Password</h1>

<form id="resetPasswordForm" asp-action="ResetPassword" asp-controller="Account" method="post" onsubmit="return validatePassword()">
    @Html.AntiForgeryToken()
    <div class="mb-3">
        <label for="userID" class="form-label">UserID:</label>
        <input type="text" class="form-control" id="userID" name="userID" value="@ViewBag.UserID" readonly/>
    </div>
    <div class="mb-3">
        <label for="newPassword" class="form-label">New Password:</label>
        <input type="password" class="form-control" id="newPassword" name="newPassword" required>
    </div>
    <div class="mb-3">
        <label for="confirmPassword" class="form-label">Confirm Password:</label>
        <input type="password" class="form-control" id="confirmPassword" required>
    </div>
    <p id="confirmPasswordMessage"></p>

    <button type="submit" class="btn btn-primary" id="submitButton">Reset Password</button>
</form> *@

<div class="form-box">
    <!-- Reset Password Form -->
    <div id="resetPasswordForm">
        <h2>Reset Password</h2>
        @if (TempData["WarningMessage"] != null)
        {
            <div class="alert alert-warning" id="loginErrorMessage">
                @TempData["WarningMessage"]
            </div>
        }
        
        <form asp-action="ResetPassword" asp-controller="Account" method="post">
            @Html.AntiForgeryToken()
            <div class="mb-3">
                <label for="resetUserIdConfirm" class="form-label">User ID</label>
                <input type="number" class="form-control readonly-input" id="resetUserIdConfirm" name="userID" value="@ViewBag.UserID" readonly>
            </div>

            <label for="newPassword" class="form-label">New Password</label>
            <div class="mb-3 position-relative">
                <input type="password" class="form-control" id="newPassword" name="newPassword" placeholder="Enter new password" required>
                <!-- Eye toggle button -->
                <button type="button" class="position-absolute top-50 end-0 translate-middle-y me-2"
                        onclick="togglePasswordVisibility('newPassword', 'newPasswordEye')"
                        style="border: none; background: transparent;">
                    <i id="newPasswordEye" class="bi bi-eye"></i>
                </button>
            </div>

            <div class="mb-2">
                <div class="progress" style="height: 6px;">
                    <div id="passwordStrengthBar" class="progress-bar" role="progressbar" style="width: 0%;"></div>
                </div>
                <small id="passwordStrengthText" class="form-text"></small>
            </div>

            <label for="confirmPassword" class="form-label">Confirm Password</label>
            <div class="mb-3 position-relative">
                <input type="password" class="form-control" id="confirmPassword" placeholder="Confirm new password" required>
                <!-- Eye toggle button -->
                <button type="button" class="position-absolute top-50 end-0 translate-middle-y me-2"
                        onclick="togglePasswordVisibility('confirmPassword', 'confirmPasswordEye')"
                        style="border: none; background: transparent;">
                    <i id="confirmPasswordEye" class="bi bi-eye"></i>
                </button>
            </div>

            <p id="confirmPasswordMessage"></p>

            <button type="submit" class="btn btn-primary">Confirm Reset</button>
        </form>
    </div>
</div>

@section Scripts {
    <script>
        // function validatePassword(event) {
        //     var newPassword = document.getElementById("newPassword").value;
        //     var confirmPassword = document.getElementById("confirmPassword").value;

        //     if (newPassword !== confirmPassword) {
        //         // alert("Passwords do not match!");
        //         // showCustomAlert("Message", "Passwords do not match!");
        //         document.getElementById("confirmPasswordMessage").textContent = "Passwords do not match!";
        //         document.getElementById("confirmPasswordMessage").style.color = "red";
        //         return false;
        //     }
        //     return true;
        // }
        function togglePasswordVisibility(passwordFieldId, eyeIconId) {
            const passwordField = document.getElementById(passwordFieldId);
            const eyeIcon = document.getElementById(eyeIconId);

            if (passwordField.type === "password") {
                passwordField.type = "text";
                eyeIcon.classList.remove('bi-eye');
                eyeIcon.classList.add('bi-eye-slash');
            } else {
                passwordField.type = "password";
                eyeIcon.classList.remove('bi-eye-slash');
                eyeIcon.classList.add('bi-eye');
            }
        }

    </script>
    <script src="~/js/resetPasswordValidation.js"></script>
}


